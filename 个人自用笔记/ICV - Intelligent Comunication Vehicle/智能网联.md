企业

- 北京华云安-150人





# 1. 智能网联汽车

## ICV

- 智能网联汽车
- Intelligent Comunication Vehicle
- 有：传感器. 控制器. 执行器. 
- 用：通信 和 网络技术
- 实现： 信息交换共享. 环境感知. 智能决策. 协同控制
- 实现：安全 高效 舒适 节能
- 实现：替代人
- Vehicle：V2V，V2I基础设施， V2P， V2C，V2X（统称）

- 三个层级（高到低
  - ICV
  - ADS / Autonomous Driving Solution 自动驾驶系统
  - ADAS / Advanced Driver Assistance Systems 高级驾驶辅助系统



### ADAS - 基本

1. AEB / 自动制动系统 Autonomous Emergency Braking
2. ACC / 自适应巡航 Adaptive Cruise Control
3. LKA / 车道保持系统 Lane Keeping Assist
4. TSR / 交通标识识别 Traffic Sign Recognition
5. PCW / 行人保护系统 Pedestrian Collision Warning
6. DSM / 驾驶员疲劳检测 Driver Status Monitor
7. PAS / 驻车辅助 Parking Assist System
8. RCW / 尾巴部碰撞 Rear Collision Warning
9. ….



### 标准分级

- L0\L1\L2 已经量产
  - C-NCAP 五星安全推动 速度飞快

- L3 - 争议，噱头，手离开方向盘
- L4 （高度无人驾驶） 示范园测试中
- L5 完全无人驾驶

![image-20230315185521991](./assets/image-20230315185521991.png)





### 发展方向

1. 自主式汽车 （单车
   - 安装传感器，不用网络
   - e.g. 如google，百度
   - good:
     - 不依赖别人
   - bad:
     - 装备高成本
     - False Positive / True Negative 很多
     - 角度测量不精确
     - 感知位置，不感知状态
     - 探测距离有限，距离200米
     - 安全性差

2. 网联式汽车 （物联网
   - V2V， V2P，用网络
   - good：
     - 成本低
     - 探测距离远
   - bad：
     - 取决于技术渗透率 5G



### 5G

- 5G是必要条件 -> 需要大带宽

- 物联网

- 很大的流量
- 我国可以与众不同



### 前景

- bad：需求减少
- good：新能源，5G，人工智能



### ICV 关键技术

- 智能互联 V2X
- 车载网络
- 信息安全
- 云计算-云储存
- 信息融合
- ADAS
- 高精度地图定位
- 无线通讯
- 中央决策
- 环境感知
- 人机界面



# 2. 信息安全

## 信息安全风险评估 - 安全测试实施

大局

- 一开始只能把车拆了
- 现在功能越多模块越多，攻击的点越多

例子

- 30-40米
  - 不接触钥匙->开车门得（无线电波）时候抓包 -> 重放
  - 方法：加入新鲜级别

- 特斯拉NFC - 就像小区门禁卡
- 数字钥匙 - 蓝牙手机钥匙
  - app安全
  - 蓝牙传输通道安全
    - 传统-传的大
    - 低功耗-传得少
      - 嗅探攻击



被测风险点变多

- 车载以太网
  - 拆了，固件提取，逆向工程，拿到系统程序
  - usb调试口-> 驱动-> 操作系统
- 传统网络安全：
  - 信息收集，端口扫描，漏洞，渗透
  - 一般setup：目标有个系统刚好有个web服务

- 3个屏幕一个硬件
  - 用 virtual machine 
  - 通过车载以太网网线 -> IP
  - 仪表：Linux
    - SSH / Telnet 端口调试 -> 一般能得到root权限
  - 车机：Android
    - 5555端口一般是开放的（ABD调试端口）

- 端口
  - 传统
  - 厂家定义的端口
    - log里面信息容易泄露 用 `netcat`



自动驾驶

- 功能域
- 自动驾驶域 - 很好攻击 - 只要有接口
  - 关联动力域
  - 高算力的因韦达嵌入式设备
  - 都有操作系统，有模组

- 传感器安全
  - 摄像头/雷达
  - 一个激光就可以欺骗传感器

- 数据采集的安全 - 个人隐私
  - 特斯拉不能进入信息敏感区域
    - 主驾摄像头非常清晰
  - 传感器 -> 内网 -> tbox
    - 传输过程
  - tbox -> 4G/5G -> 云端
    - 传输过程

- 云端安全
  - app -> url -> 接口 -> 逆向 -> 手机操控汽车
  - 破解密钥 -> 下发病毒 -> 后门控制



**WP29强标**要求



重复性操作：通用化测试脚本

- 三行命令
  - 配置网卡
  - 调参
  - 钓鱼热点开启
- 对方连上热点
- 抓包-几万条 -> 分别



深度挖掘对人的挖掘比较高

- 逆向 -> 业务攻击点 -> 调取了存储的密钥
- 等级最高为5. 测试是2，我是3就会打不了



打ctf：

- web / 2进制 / 物联网



## 漏洞安全

- 漏洞增长很大
- 漏洞严重影响国家关键基础设施运营

![image-20230315190433550](./assets/image-20230315190433550.png)

![image-20230315190616334](./assets/image-20230315190616334.png)

![image-20230315190752307](./assets/image-20230315190752307.png)





# 3. 智能网联汽车安全测试

ICV Cyber Security Technology System

ICVTP

汽车测试网



# **总结：**

- 智能化联网化->暴露面大—>衍生安全漏洞->安全分级：5个，S0轻-S4重
- 云端vs车端
- 自动驾驶：
  - 功能域/自动驾驶域/传感器安全/数据采集的安全 - 个人隐私/云端安全
- 远程，进程，接触攻击
- 危害程度：一般，严重，致命

# 问题：

- 咱们做的是国际标准得落地 还是 单纯的自主研发？
- 国际上的事情？



### 分类

**云端（TSP云端运营系统）**

- 接触式攻击
- 远程攻击 
  - 侵入云端服务
  - 通过移动应用
- 近程攻击
  - 侵入云端服务

**车端**

- **T-box**
  - 近程攻击/现场通讯攻击
    - 蓝牙
    - Wifi
    - NFC
    - 汽车本身的协议：协议和中央网关
- **IVI娱乐信息系统音频、视频、导航外部的多媒体设备/电话**
  - 远程
    - 通过恶意网站
- **CAN Gateway**
  - 接触式攻击
    - 通过OBD接口，对CAN指令发送恶意报文
- **CAN Bus**
- **车身控制系统仪表板、空调、门锁、大灯、方向/双闪灯、车窗、座椅等**
  - 接触式攻击
    - 恶意或者有漏洞的ECU
- **底盘控制系统转向、刹车、气囊、后视镜系统**
  - 接触式攻击
    - 恶意或者有漏洞的ECU



### **评估方法**

- 依据（微软的）Stride模型和攻击类别，制定了相应测试方法和测试规范
  - 冒充
  - 篡改
  - 抵赖
  - 信息泄露
  - 拒绝服务
  - 权限提升

- 评估方式
  - 渗透测试攻击扫描、抓包
  - 安全漏洞人工验证（人工审计）

- 评估内容

  - TSP云平台安全
    - OWASP TOP10 or CWE TOP25
    - 传统IT信息化的评估手段

  - TSP系统平台
    - 数据中心和网络检测
      - 防火墙，基础安全，防攻击
    - 日志安全
    - 数据存储
    - 系统平台检测
  - 车辆-TSP平台-移动APP之间通信安全：
    - 双向认证，传输加密得方式等
  - 整车安全
    - 固件
    - HU(IVI)和通信安全测试
      - ACU
        - CAN检测
        - 端口检测
      - 通信安全
        - 通信协议检测
        - 数字证书检测
        - 通信数据加密检测
    - TBOX
      - 主板检测
      - 存储固件检查
      - 应用检测
      - 授权检测
      - 通信端口检测
      - 安全审计
        - boot loader防篡改
        - root提权
    - 硬件
    - 接口
    - 存储
    - 系统
    - 软件
    - OTA / Over-The-Air / 软件更新
      - TBOX远程升级安全检测
        - 完整性和私密性
        - 降版本攻击
    - 总线
  - 手机APP安全
    - 应用软件
      - 代码静态扫描，动态调试，反编译防范，进程注入
      - **身份认证**逻辑，绑定号
    - 数据存储安全性
      - 敏感信息存储与恢复



### 流程4部

- ![image-20230315182649744](./assets/image-20230315182649744.png)



### 仿真环境搭建（安全测试和研究流程）

仿真-> 台架 -> 实车



仿真环境-低成本高效率

- 安全测试
- 漏洞搜索与验证

台架环境-汽车零部件构建的汽车电气化架构（问题：型号单一）

- 构造测试工具
- 初步结果验证

实车环境

- 最终安全验证
- 普适性测试



仿真环境

![image-20230315183614056](./assets/image-20230315183614056.png)

- 工具库
- 业务逻辑
- 逻辑层
- 硬件环境

![image-20230315183731009](./assets/image-20230315183731009.png)

![image-20230315183919047](./assets/image-20230315183919047.png)







## 网络安全专项检查

- 网信办：[国家互联网信息办公室](https://zh.wikipedia.org/wiki/国家互联网信息办公室)

- 人大常委：[全国人民代表大会常务委员会 ](https://zh.wikipedia.org/wiki/全国人民代表大会常务委员会)





一年一轮

- 管理抽查办法
  - 现场访谈
  - 规范文档核查
  - 落实记录核查
- 技术抽查办法
  - 网络架构安全分析
  - 安全配置检查
  - 漏洞扫描测试
  - 渗透性测试



网络安全

**中华人民共和国网络安全法**

**中华人民共和国密码法**

**网络安全等级保护基本要求**

**通信网络安全防护管理办法** 工信部11号令

**关键信息基础设施安全保护条例（征求意见稿）**





- 2021年6月10日 -> 人大常委 -> **中华人民共和国数据安全法**
- 2021年7月10日 -> 网信办 -> 修订 **网络安全审查办法**
- 2021年7月12日 -> 公信网信办 -> **网络产品安全漏洞管理**



- 通讯安全

- 软件安全
- 数据安全
- 设施安全（云）



上海网络安全专项检查组成

- 市委网信办
- 市公安局
- 市通信管理局
- 专家组
- 市密码管理局
- 行业主管部门



# 4. 国际标准用语

## 用语

**Automotive Cybersecurity**

- ACES
  - Autonomy, Convergence, Ecology, Services

- 排名前五的攻击
  - 针对车钥匙/key fob，服务器，智能手机app，OBD，head unit/车载信息娱乐系统

**两个标准**

- **UNECE Regulation R.155**

- **ISO/ 21434**



**UNECE**

- 联合国欧洲经济委员会
- 下属的
- **WP29**：世界车辆法规论坛



**R.155**

- Cyber Security and Cyber Security Management
- **CSMS** - Cyber Security Management System



**R.156**

- Software Update Processes and Management Systems
- **SUMS** - Software Update Management Systems



**Type Approval** 

- 形式认证

Vehicle Type Approval / **VTA**

- 车辆形式认证
- 保证商品满足最低限度得监管，技术和安全要求
- 在特定国家销售前必须的认证



**RxSWIN** / RX Software Identification Number / 软件标识码

- 软件部分vs形式认证 相关的信息
- 唯一可识别
- e.g. 通过OBD端口



![image-20230315205525276](./assets/image-20230315205525276.png)



**中国标准**

![image-20230315205659978](./assets/image-20230315205659978.png)



**日韩**

![image-20230315205812215](./assets/image-20230315205812215.png)



![image-20230315210023205](./assets/image-20230315210023205.png)





## ISO/SAE 21434

![image-20230315210407149](./assets/image-20230315210407149.png)



![image-20230315210621755](./assets/image-20230315210621755.png)



## R.155/CSMS and R.156/SUMS

![image-20230315210646266](./assets/image-20230315210646266.png)



![image-20230315210809738](./assets/image-20230315210809738.png)

### R.155

过程需求：

![image-20230315211306369](./assets/image-20230315211306369.png)

形式认证需求：

![image-20230315211453034](./assets/image-20230315211453034.png)



### R.156

过程需求：

![image-20230315211824092](./assets/image-20230315211824092.png)

形式认证需求：

![image-20230315211946773](./assets/image-20230315211946773.png)



### RxSWIN 

![image-20230315213331046](./assets/image-20230315213331046.png)





# 5.中国标准

**中国标准**

![image-20230315205659978](./assets/image-20230315205659978.png)



## 汽车信息安全通用

##  技术要求

标准号：GB/T 40861-2021

中文标准名称：**汽车信息安全通用技术要求**                 

英文标准名称：General technical requirements for vehicle cybersecurity 

主管部门：工业和信息化部

发布单位：国家市场监督管理总局、中国国家标准化管理委员会



对博世中国物联网黑客马拉松活动非常感兴趣，非常希望我对ICV白帽得热爱可以在博世延续。曾留英多年我相信我更加适应能适应公司的文化和需求。



## 汽车整车信息安全技术要求

2021/06/28 -  征求意见稿



## 汽车软件升级 通用技术要求

2200/06/17 - 征求意见稿

















UNECE/WP.29/GRVA组织架构

- MR155
- MR156
  - 信息安全
  - 网络升级

![image-20230315185404930](./assets/image-20230315185404930.png)





ISO/TC22只能网联汽车相关工作组

![image-20230315185417936](./assets/image-20230315185417936.png)



![image-20230315185651983](./assets/image-20230315185651983.png)

![image-20230315185710971](./assets/image-20230315185710971.png)



![image-20230315185747229](./assets/image-20230315185747229.png)



![image-20230315185828400](./assets/image-20230315185828400.png)

![image-20230315185859460](./assets/image-20230315185859460.png)



![image-20230315190000842](./assets/image-20230315190000842.png)



![image-20230315190020518](./assets/image-20230315190020518.png)



![image-20230315190153812](./assets/image-20230315190153812.png)



# 6. 身份认证 / Authentication

- 只是输入密码？和网络端有什么关系呢？
- 妈呀这得多快得网
- 密码学要求很高
  - 又快又准确




## 概念

**国家车联网产业标准体系建设指南**：

![image-20230315222521480](./assets/image-20230315222521480.png)



**身份认证与安全**

- 在车联网环境下，智能网联汽车身份认证 
  - 主要支撑： 智能网联汽车 和 道路交通管理系统、设施之间身份互认，
  - 主要包括： 智能网联**汽车**身份与安全、道路交通管理**设施**身份与安全、身份认证**平台**及电子**证件**等 3 类标。



**智能网联汽车身份与安全**

- 使用可信的数字**身份标识**智能网联汽车真实身份，
  - 主要包括
    - 智能网联汽车数字身份**编码规范**、
    - 智能网联汽车数字身份**通用技术规范**
    - 等标准。 



**道路交通管理设施身份与安全**

- 车联网环境下，需要安装专用**识读设备**，读取或写入智能网联汽车相关身份信息；
- 接入车联网的道路交通管理设施需加注 **数字身份**，
- 设施与设施、设施与系统之间需进行**身份互认**。
  - 主要包括
    - 道路交通管理设施 **数字身份** 通用**技术规范**、
    - 机动车电子证件 **识读设备** 通用**技术规范**
    - 等标准。 



**身份认证平台 及 电子证件**

身份认证平台 主要提供

- 身份**注册**、身份**认证**、身份**注销**等**身份管理**服务，
- **密钥分发**管理 及 **证书管理**功能。

身份认证平台 包含 

- 智能网联汽车 电子**证件发行管理**系统，用于 **管理**电子证件发行，**提供** 电子证件相关**应用服务**。
  - 主要包括 
    - 机动车身份认证 系统 技术要求、
    - 机动车身份认证 系统 服务接口规范、
    - 密钥分发管理 系统 技术要求
    - 等标准





**工业和信息化部办公厅关于开展车联网身份认证和安全信任试点工作的通知**

- 工业和信息化部办公厅
- 成文日期：2021年06月08日
- [link](http://www.gov.cn/zhengce/zhengceku/2021-06/10/content_5616843.htm)



## 试点方向

- 车与云安全通信
- 车与车安全通信
  - 量产
  - 宝马

- 车与路安全通信

- 车与设备安全通信



车与云

- 技术要求
  - 通过基于商用密码 的 数字证书、数字签名、数据加密技术，
    - 实现 车载信息交互系统、汽车网关、C-V2X车载通信设备等 与 车联网服务平台间的安全通信。
  - 基于安全链路协议，
    - 建立车云通信安全隧道，
    - 保护车云通信数据机密性和完整性。
  - 基于密码应用中间件，
    - 在车端实现消息封装、证书管理，
    - 在平台侧实现证书验证、数据解析。
  - 车载设备按照有关标准实现与证书管理系统、相关车联网安全信任根的数据交互。

- 应用场景
  - 场景：车端与车企云平台、路侧边缘云平台、智能辅助驾驶服务平台、车载信息服务云平台、高精动态地图服务平台 等车联网服务平台的车云通信
  - 实现：车辆可信接入、车辆定位 及 感知数据的可信采集、车辆状态信息的 可信上传、汽车远程升级 可信验证、基于安全链路的 可信车云交互等 车云通信应用

- 目标
  - 研发 建立车云通信身份认证、数据加密等技术能力，
  - 实现 各类车云通信场景下的身份认证、数据机密性和完整性保护
  - 构建 车云通信安全保障能力。



车与车

- 技术要求

  1. 在车端应用：

     - 基于商用密码的安全芯片、软件模块等组件，

     - 实现密钥管理、证书管理、安全计算等车端安全凭证管理和数据处理功能。

  2. 通过 车辆生产环节配置、运营商通道配置、服务器令牌授权等方式
     - 实现 车载设备证书初始化。

  3. 建立 车载设备证书管理系统，
     - 为车载设备提供证书发布、更新、撤销等证书管理服务。

  4. 车载设备按照有关标准
     - 实现数据交互： 实现与证书管理系统、相关车联网安全信任根 和 工业和信息化部车联网安全信任根管理平台的数据交互

- 应用场景
  - 在重点城市、高速公路、物流园区、港口、矿山、科技园区等场景下，
  - 实现基于安全通信的辅助驾驶和有条件自动驾驶应用，包括碰撞预警、盲区预警、变道辅助、异常车辆提醒、编队行驶等。

- 试点目标
  - 试点单位研发建立 车车通信身份认证技术能力，对具备直连通信功能的C-V2X车型进行证书管理，通过接入相关车联网安全信任根 和 工业和信息化部车联网安全信任根管理平台，在车辆驾驶应用场景中开展跨信任域的身份认证，保障多品牌车辆的安全通信，构建车车通信安全保障能力。





车与路安全通信

1.技术要求

- 路侧设备通过 搭载基于商用密码的安全芯片、软件模块等组件，
  - 实现 安全凭证管理和数据处理功能。
- 建立 路侧设备证书管理系统，
  - 为路侧设备提供证书发布、更新、撤销等证书管理服务。
- 路侧设备按照有关标准
  - 实现与车载设备、证书管理系统、相关车联网安全信任根和工业和信息化部车联网安全信任根管理平台的数据交互。

2.应用场景

- 在重点城市、高速公路、封闭测试场、车路协同试点路段等场景下，
- 实现基于安全通信的安全预警、效率提升等车路协同应用，包括红绿灯提醒及绿波通行、道路交通信息提示、弱势交通参与者提醒、公交优先通行、自动驾驶测试等。

3.试点目标

- 试点单位研发建立车路通信身份认证技术能力，
- 对试点区域具备直连通信能力的C-V2X通信设备进行证书管理，
- 通过接入相关车联网安全信任根和工业和信息化部车联网安全信任根管理平台，
- 开展跨信任域的身份认证，
- 保障本区域多类路侧设备与车辆的车路安全通信，
- 构建车路通信安全保障能力。



车与设备安全通信

1.技术要求

- 通过基于商用密码的数字证书、数字签名、数据加密技术，
- 实现车载信息交互系统 与 手持移动智能终端、新能源汽车与充电桩等 车与外部设备交互场景的安全通信。
- 基于商用密码技术，实现车载短距无线通信场景中的密钥可信交换和安全保护，采用安全协议对通信链路进行加密。

2.应用场景

实现基于身份认证和加密技术的车与设备通信应用，包括用户手持移动智能终端的车辆远程控制、车辆信息查询、安全预警等应用，无钥匙进入、车载设备互联等车载短距无线通信应用，以及新能源汽车充电应用等。

3.试点目标

试点单位研发建立身份认证、安全加固等技术能力，支持各类车与设备通信场景下的身份认证、数据机密性和完整性保护，构建车与设备通信安全保障能力。





# 7. 专业术语

- OTA 
  - Over-The-Air 
  - 软件更新
- CAN
  - Controller Area Network
  - 控制器局域网络
- ECU
  - Electronic Control Unit
  - 电子控制单元
- TSP
  - （Telematics Service Provider）
  - 汽车远程服务提供商

- OBD
  - On-Board Diagnostics
  - 车载自动诊断系统
  - 市场也有卖100块的OBD盒子，实际就是读取一下车子的数据而已；
  - 把这个OBD接口插到CAN总线接口上面，就可以读写数据了；
- T-BOX = 无线网关 = 通信模块 兼顾远程操控和数据收集
  - 通过：G远程无线通讯、GPS卫星定位、加速度传感和CAN通讯等功能
  - 为整车提供服务：远程通讯接口，提供包括行车数据采集、行驶轨迹记录、车辆故障监控、车辆远程查询和控制（开闭锁、空调控制、车窗控制、发送机扭矩限制、发动机启停）、驾驶行为分析、4G无线热点分享等
  - 有各种各样的接口与总线相连，
    - 不仅包括传统的控制器局域网CAN（Controller Area Network）、局域互联网络LIN （Local Interconnect Network）以及调试接口RS232/RS485/USB2.0等，
    - 还包括了汽车总线“新贵”车载以太网（Ethernet）

  - ![image-20230315230011549](./assets/image-20230315230011549.png)

- V2X
  - Vehicle to Everything 
- DoS
  - Denial of Service
  - 拒绝服务
- DDoS
  - Distributed Denial of Service
  - 分布式拒绝服务

